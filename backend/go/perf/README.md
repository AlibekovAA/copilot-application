# Нагрузочное тестирование Go бекенда

## Установка зависимостей

```bash
pip install -r requirements.txt
```

## Запуск Go сервера

```bash
docker-compose -f docker-compose.go-only.yml up --build -d
```

## Запуск нагрузочного тестирования

### Базовый запуск:

```bash
python load_test.py
```

### С параметрами:

```bash
python load_test.py --url http://localhost:8080 --users 50 --duration 120 --ramp-up 10
```

### Параметры:

- `--url` - Базовый URL сервера (по умолчанию: http://localhost:8080)
- `--users` - Количество concurrent пользователей (по умолчанию: 100)
- `--duration` - Длительность теста в секундах (по умолчанию: 120)
- `--ramp-up` - Время постепенного увеличения нагрузки в секундах (по умолчанию: 0)
- `--output` - Путь для сохранения результатов в JSON формате

### Примеры:

Тест с 100 пользователями на 2 минуты:

```bash
python load_test.py --users 100 --duration 120
```

Тест с постепенным увеличением нагрузки:

```bash
python load_test.py --users 50 --duration 180 --ramp-up 30
```

Сохранение результатов в файл:

```bash
python load_test.py --users 20 --duration 60 --output results.json
```

## Собираемые метрики

Скрипт собирает следующие метрики:

- **Общие метрики:**

  - Длительность теста
  - Общее количество запросов
  - Количество успешных/неудачных запросов
  - Процент успеха
  - Requests Per Second (RPS)

- **Время отклика:**

  - Min, Max, Mean, Median
  - Процентили: P50, P75, P90, P95, P99
  - Стандартное отклонение

- **Коды ответов:**

  - Распределение HTTP статус кодов
  - Процентное соотношение

- **Ошибки:**

  - Типы ошибок и их количество

- **Метрики по эндпоинтам:**
  - Количество запросов на эндпоинт
  - Среднее время отклика
  - P95 и P99 процентили

## Тестируемые эндпоинты

- `POST /register` - Регистрация пользователей
- `POST /login` - Авторизация
- `GET /api/profile` - Получение профиля (требует токен)
- `GET /health` - Проверка работоспособности

## Остановка сервера

```bash
docker-compose -f docker-compose.go-only.yml down
```

Для удаления данных БД:

```bash
docker-compose -f docker-compose.go-only.yml down -v
```
